\section{The algorithm C2}

The algorithm we refer to as C2 was originally proposed in
\cite{Cou96}. It takes as input two elliptic curves $E, E'$ and an odd
prime $\ell$ different from $p$ and it returns, if it exists, an
$\F_q$-rational isogeny of degree $\ell$ between $E$ and $E'$. It only
works in odd characteristic.

\paragraph{The idea} Suppose it exists an $F_q$-rational isogeny
$\I:E\rightarrow E'$ of degree $\ell$. Since $\ell\ne p$ one has
$\I(E[p^k]) = E'[p^k]$.

Recall that $E[p^k]$ and $E'[p^k]$ are cyclic groups, C2 iteratively
computes generators $P_k,P_k'$ of $E[p^k]$ and $E'[p^k]$
respectively. Now C2 makes the guess $\I(P_k) = P_k'$, then, if $\I$
is given by rational fractions as in \eqref{eq:isog},
\begin{equation}
  \label{eq:C2:I}
  \frac{g\bigl(x([i]P_k)\bigr)}{h\bigl(x([i]P_k)\bigr)} = x([i]P_k')
  \quad\text{for $i\in(\Z/p^k\Z)^\ast$} 
\end{equation}
and by \eqref{eq:velu-deg} $\deg g = \deg h + 1 = \ell$.

Observe that having primitive points in $E[p^k]$, using
\eqref{eq:C2:I} one can compute the rational fraction
$\frac{g(X)}{h(X)}$ through Cauchy interpolation over such points as
in \cite[5.7]{vzGG}. C2 takes $\frac{\euler(p^k)}{2} > 2\ell - 1$,
interpolates the rational fraction and then checks that it corresponds
to the restriction of an isogeny to the $x$-axis. If this is the case,
the whole isogeny is computed through VÃ©lu formulae and the algorithm
terminates.  Otherwise the guess $\I(P_k) = P_k'$ was false; then C2
computes a new generator for $E'[p^k]$ and starts over again.

We now go through the details of the algorithm.

\paragraph{The $p$-torsion}
The computation of the $p$-torsion points follows from the work of
Gunji \cite{Gun76}. 

\begin{definition}
  \label{def:hasse}
  Let $E$ have equation $y^2 = f(x)$, one defines the \emph{Hasse
    invariant} of $E$, noted $H_E$ as the coefficient of $X^{p-1}$ in
  $f(X)^{\frac{p-1}{2}}$.
\end{definition}

\begin{proposition}
  Let $c=\sqrt[p-1]{H_E}$, then the $p$-torsion points of $E$ are
  defined in $\F_q[c]$ and their abscissae are defined in $\F_q[c^2]$.
\end{proposition}


\paragraph{The $p^k$-torsion}


% Local Variables:
% mode:flyspell
% ispell-local-dictionary:"british"
% mode:TeX-PDF
% TeX-master: "ec-isogeny"
% End:
%
% LocalWords:  Schreier Artin pseudotrace frobenius bivariate Joux Sirvent FFT
% LocalWords:  Couveignes isogenies Schoof isogeny cryptosystems Lercier
% LocalWords:  precomputation arithmetics polylogarithmic Karatsuba
% LocalWords:  endomorphisms
